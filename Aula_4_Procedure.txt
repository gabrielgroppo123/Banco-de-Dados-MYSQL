SELECT * from actor;

select * from customer;

describe customer;



SELECT * from address;

describe address;

insert into address (address, district, city_id,postal_code, phone,location)
    VALUES('AV euzebio, 555', 'Sta Amaro', 463, '83838', '3338888', ST_GeomFromText('POINT(153.1408538 -27.6333361)'));

insert into customer (store_id, first_name, last_name, email, address_id, create_date)
    VALUES(1 , 'Romulo', 'Maia', 'sdjahd@ajshdk.com', LAST_INSERT_ID(), now());


create PROCEDURE cadastra_cli(primeiro_nome varchar(20), sobrenome varchar(20), email varchar(40), endereco varchar(50), bairro varchar (30), cep varchar (8), telefone varchar(15), nome_cidade varchar(50))

begin
DECLARE cidade_id INT;
SELECT city_id INTO cidade_id
    FROM city
    WHERE city = nome_cidade
    LIMIT 1;

  
    IF cidade_id IS NULL THEN
        INSERT INTO city (city, country_id, last_update)
        VALUES (nome_cidade, 1, NOW());  
        SET cidade_id = LAST_INSERT_ID();
    END IF;

insert into address (address, district, city_id,postal_code, phone,location)
    VALUES(endereco, bairro, cidade_id, cep, telefone, ST_GeomFromText('POINT(153.1408538 -27.6333361)'));

insert into customer (store_id, first_name, last_name, email, address_id, create_date)
    VALUES(1 , primeiro_nome, sobrenome, email, LAST_INSERT_ID(), now());

END;

call cadastra_cli("Joao", "Silva", "aidjwo@gmail.com", "Av Paulis,555", "Jardim Paulista","92993922", "67122-1231", "SÃ£o Paulo");

SELECT*from customer;

drop Procedure cadastra_cli;

SELECT*from city;

SELECT* from address;